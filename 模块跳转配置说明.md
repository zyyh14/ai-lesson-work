# 🔗 AI备课系统 - 模块跳转配置说明

## 📊 系统架构

本系统采用**微前端架构**，每个功能模块独立运行在不同的端口上。

```
┌─────────────────────────────────────────────────────────┐
│                    AI备课系统                            │
│                  (Dashboard首页)                         │
│                http://localhost:3001                     │
└─────────────────────────────────────────────────────────┘
                           │
        ┌──────────────────┼──────────────────┐
        │                  │                  │
        ▼                  ▼                  ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│  教案模块     │  │  资源模块     │  │  学情分析     │
│  :3000       │  │  :3002       │  │  :3003       │
└──────────────┘  └──────────────┘  └──────────────┘
```

---

## 🌐 模块端口映射

| 模块名称 | 端口 | 访问地址 | 说明 |
|---------|------|----------|------|
| **PPT模块（主入口）** | 3001 | http://localhost:3001 | Dashboard首页 + PPT编辑器 |
| **教案模块** | 3000 | http://localhost:3000 | 教案生成和管理 |
| **资源管理模块** | 3002 | http://localhost:3002 | 教学资源库 |
| **学情分析模块** | 3003 | http://localhost:3003 | 学情数据分析 |

---

## 🔄 跳转逻辑

### 1. Dashboard首页跳转

**位置：** `frontend/modules/ppt/pages/dashboard.tsx`

**跳转方式：**

```typescript
const modules = [
  {
    title: "智能教案生成",
    external: true,                    // 外部链接
    externalUrl: "http://localhost:3000"  // 新窗口打开
  },
  {
    title: "智能课件制作",
    external: false,                   // 内部路由
    path: "/ppt-editor"                // 当前应用内跳转
  },
  {
    title: "教学资源库",
    external: true,
    externalUrl: "http://localhost:3002"
  },
  {
    title: "学情分析中心",
    external: true,
    externalUrl: "http://localhost:3003"
  }
];
```

**处理函数：**

```typescript
const handleModuleClick = (module: any) => {
  if (module.external && module.externalUrl) {
    // 外部模块：新窗口打开
    window.open(module.externalUrl, '_blank', 'noopener,noreferrer');
  } else {
    // 内部路由：使用React Router
    navigate(module.path);
  }
};
```

### 2. 侧边栏导航跳转

**位置：** `frontend/modules/ppt/pages/dashboard.tsx`

```typescript
// 教案管理 - 外部链接
<button onClick={() => window.open('http://localhost:3000', '_blank')}>
  教案管理
</button>

// 课件制作 - 内部路由
<button onClick={() => navigate('/ppt-editor')}>
  课件制作
</button>

// 资源库 - 外部链接
<button onClick={() => window.open('http://localhost:3002', '_blank')}>
  资源库
</button>

// 学情分析 - 外部链接
<button onClick={() => window.open('http://localhost:3003', '_blank')}>
  学情分析
</button>
```

---

## 📝 路由配置

### PPT模块路由（主应用）

**位置：** `frontend/modules/ppt/App.tsx`

```typescript
<Router>
  <Routes>
    <Route path="/" element={<Dashboard />} />
    <Route path="/dashboard" element={<Dashboard />} />
    <Route path="/ppt-editor" element={<PresentationEditor />} />
    <Route path="*" element={<Navigate to="/" replace />} />
  </Routes>
</Router>
```

**说明：**
- `/` 和 `/dashboard` - Dashboard首页
- `/ppt-editor` - PPT编辑器
- 其他路径 - 重定向到首页

---

## 🎯 用户使用流程

### 方式1：从Dashboard进入（推荐）

1. 访问 http://localhost:3001
2. 看到Dashboard首页，显示4个模块卡片
3. 点击任意模块卡片：
   - **教案生成** → 新窗口打开 http://localhost:3000
   - **课件制作** → 当前窗口跳转到 `/ppt-editor`
   - **资源库** → 新窗口打开 http://localhost:3002
   - **学情分析** → 新窗口打开 http://localhost:3003

### 方式2：直接访问模块

用户也可以直接访问各模块的URL：

- http://localhost:3000 - 直接进入教案模块
- http://localhost:3001 - 进入PPT模块（Dashboard）
- http://localhost:3002 - 直接进入资源模块
- http://localhost:3003 - 直接进入学情分析模块

---

## 🔧 配置修改指南

### 如果端口发生变化

1. **更新Dashboard配置**

编辑 `frontend/modules/ppt/pages/dashboard.tsx`：

```typescript
const modules = [
  {
    // ...
    externalUrl: "http://localhost:新端口号"
  }
];
```

2. **更新侧边栏链接**

同样在 `dashboard.tsx` 中更新侧边栏按钮的 `onClick` 事件。

### 如果需要添加新模块

1. 在 `modules` 数组中添加新配置：

```typescript
{
  id: 5,
  title: "新模块名称",
  description: "模块描述",
  icon: <YourIcon className="w-8 h-8 text-white" />,
  color: "bg-gradient-to-br from-color-500 to-color-600",
  path: "/new-module",
  stats: "统计信息",
  external: true,
  externalUrl: "http://localhost:新端口"
}
```

2. 在侧边栏添加对应按钮。

---

## ⚠️ 注意事项

### 1. 跨域问题

由于各模块运行在不同端口，如果需要共享数据或状态，需要：
- 使用后端API作为中介
- 配置CORS允许跨域请求
- 使用localStorage/sessionStorage共享数据

### 2. 用户体验

**新窗口 vs 当前窗口：**
- ✅ **新窗口**（推荐）：用户可以同时使用多个模块
- ❌ **当前窗口**：用户需要频繁切换，体验较差

**当前配置：**
- 外部模块：新窗口打开（`_blank`）
- 内部路由：当前窗口跳转

### 3. 浏览器兼容性

使用 `window.open()` 时添加安全参数：
```typescript
window.open(url, '_blank', 'noopener,noreferrer');
```

- `noopener` - 防止新页面访问 `window.opener`
- `noreferrer` - 不发送 referrer 信息

---

## 🧪 测试跳转功能

### 测试步骤

1. **启动所有服务**
   ```powershell
   # 确保所有6个服务都在运行
   ```

2. **访问Dashboard**
   ```
   http://localhost:3001
   ```

3. **测试每个模块卡片**
   - 点击"智能教案生成" → 应该打开新窗口到 :3000
   - 点击"智能课件制作" → 应该在当前窗口跳转
   - 点击"教学资源库" → 应该打开新窗口到 :3002
   - 点击"学情分析中心" → 应该打开新窗口到 :3003

4. **测试侧边栏导航**
   - 测试每个侧边栏按钮是否正确跳转

### 预期结果

✅ 所有跳转都应该正常工作
✅ 外部模块在新窗口打开
✅ 内部路由在当前窗口跳转
✅ 没有404错误

---

## 📚 相关文件

- `frontend/modules/ppt/App.tsx` - 主应用路由配置
- `frontend/modules/ppt/pages/dashboard.tsx` - Dashboard页面和跳转逻辑
- `项目运行状态报告.md` - 完整的服务状态信息

---

## 🎉 总结

跳转配置已完成！现在：

1. ✅ Dashboard可以正确跳转到所有模块
2. ✅ 外部模块在新窗口打开
3. ✅ 内部路由使用React Router
4. ✅ 侧边栏导航也已更新

**立即测试：** 访问 http://localhost:3001 查看效果！
